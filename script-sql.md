**Complete ready-to-run Oracle Performance Health Check script** 
â€” it automatically collects **database, memory, I/O, SQL, and session performance stats** into a text report.

---

## ðŸ§© **File Name:** `oracle_perf_check.sql`

```sql
-- ===================================================================
-- ORACLE DATABASE PERFORMANCE HEALTH CHECK SCRIPT
-- Version: 1.0
-- Author : Y. Venkat Sarath (Generated by ChatGPT GPT-5)
-- Purpose: Collects Oracle DB performance metrics for quick diagnosis
-- Usage  : SQL> @oracle_perf_check.sql
-- Output : perf_report.txt
-- ===================================================================

SET ECHO OFF
SET FEEDBACK OFF
SET LINESIZE 200
SET PAGESIZE 100
SET TRIMSPOOL ON
SET TERMOUT OFF

COLUMN report_time NEW_VALUE rpt_time
SELECT TO_CHAR(SYSDATE, 'YYYYMMDD_HH24MISS') AS report_time FROM dual;
SPOOL perf_report_&&rpt_time..txt

PROMPT =============================================================
PROMPT ðŸ§  ORACLE DATABASE PERFORMANCE REPORT
PROMPT =============================================================
PROMPT Date/Time: &&rpt_time
PROMPT Hostname :
HOST hostname
PROMPT =============================================================

PROMPT
PROMPT [1] DATABASE & INSTANCE DETAILS
PROMPT -------------------------------------------------------------
SELECT name, open_mode, database_role, log_mode FROM v$database;
SELECT instance_name, status, startup_time, host_name, version FROM v$instance;

PROMPT
PROMPT [2] INITIALIZATION PARAMETERS (KEY PERFORMANCE)
PROMPT -------------------------------------------------------------
SELECT name, value 
FROM v$parameter 
WHERE name IN ('db_cache_size','shared_pool_size','pga_aggregate_target','sga_target','cpu_count','optimizer_mode');

PROMPT
PROMPT [3] TABLESPACE UTILIZATION
PROMPT -------------------------------------------------------------
SELECT df.tablespace_name,
       df.file_id,
       df.bytes/1024/1024 AS total_mb,
       (df.bytes - NVL(fs.bytes,0))/1024/1024 AS used_mb,
       NVL(fs.bytes,0)/1024/1024 AS free_mb,
       ROUND(((df.bytes - NVL(fs.bytes,0))/df.bytes)*100,2) AS pct_used
FROM dba_data_files df
LEFT JOIN (
    SELECT tablespace_name, file_id, SUM(bytes) bytes
    FROM dba_free_space
    GROUP BY tablespace_name, file_id
) fs ON df.file_id = fs.file_id AND df.tablespace_name = fs.tablespace_name
ORDER BY pct_used DESC;

PROMPT
PROMPT [4] TOP SQL BY CPU TIME
PROMPT -------------------------------------------------------------
SELECT * FROM (
    SELECT sql_id, cpu_time/1000000 cpu_sec, elapsed_time/1000000 elapsed_sec, executions, sql_text
    FROM v$sql
    WHERE executions > 0
    ORDER BY cpu_time DESC
) WHERE ROWNUM <= 10;

PROMPT
PROMPT [5] TOP SQL BY ELAPSED TIME
PROMPT -------------------------------------------------------------
SELECT * FROM (
    SELECT sql_id, elapsed_time/1000000 elapsed_sec, executions, sql_text
    FROM v$sql
    WHERE executions > 0
    ORDER BY elapsed_time DESC
) WHERE ROWNUM <= 10;

PROMPT
PROMPT [6] SYSTEM WAIT EVENTS (TOP 10)
PROMPT -------------------------------------------------------------
SELECT * FROM (
    SELECT event, total_waits, time_waited/100 time_waited_secs
    FROM v$system_event
    WHERE wait_class <> 'Idle'
    ORDER BY time_waited DESC
) WHERE ROWNUM <= 10;

PROMPT
PROMPT [7] ACTIVE SESSIONS
PROMPT -------------------------------------------------------------
SELECT s.sid, s.serial#, s.username, s.program, s.sql_id, q.sql_text, s.status, s.event, s.last_call_et/60 AS minutes_running
FROM v$session s
LEFT JOIN v$sql q ON s.sql_id = q.sql_id
WHERE s.status = 'ACTIVE'
ORDER BY s.last_call_et DESC;

PROMPT
PROMPT [8] SYSTEM STATISTICS
PROMPT -------------------------------------------------------------
SELECT name, value 
FROM v$sysstat 
WHERE name IN ('CPU used by this session','DB time','physical reads','physical writes');

PROMPT
PROMPT [9] I/O PERFORMANCE BY DATAFILE
PROMPT -------------------------------------------------------------
SELECT df.name, phyrds, phywrts, readtim, writetim,
       ROUND(readtim/DECODE(phyrds,0,1,phyrds),2) avg_read_ms,
       ROUND(writetim/DECODE(phywrts,0,1,phywrts),2) avg_write_ms
FROM v$filestat fs, v$datafile df
WHERE fs.file# = df.file#
ORDER BY avg_read_ms DESC;

PROMPT
PROMPT [10] PGA MEMORY USAGE
PROMPT -------------------------------------------------------------
SELECT name, value/1024/1024 AS mb
FROM v$pgastat
WHERE name IN ('aggregate PGA target parameter','total PGA allocated','total PGA inuse');

PROMPT
PROMPT [11] SGA BREAKDOWN
PROMPT -------------------------------------------------------------
SELECT pool, name, bytes/1024/1024 AS mb
FROM v$sgastat
ORDER BY bytes DESC;

PROMPT
PROMPT [12] BUFFER CACHE HIT RATIO
PROMPT -------------------------------------------------------------
SELECT ROUND((1 - (phy.value / (cur.value + con.value))) * 100, 2) AS buffer_cache_hit_ratio
FROM v$sysstat cur, v$sysstat con, v$sysstat phy
WHERE cur.name = 'db block gets'
AND con.name = 'consistent gets'
AND phy.name = 'physical reads';

PROMPT
PROMPT [13] LIBRARY CACHE EFFICIENCY
PROMPT -------------------------------------------------------------
SELECT namespace, gets, gethits, ROUND(gethits*100/gets,2) AS gethit_ratio,
       pins, pinhits, ROUND(pinhits*100/pins,2) AS pinhit_ratio
FROM v$librarycache;

PROMPT
PROMPT [14] REDO LOG SWITCHES (LAST 24 HOURS)
PROMPT -------------------------------------------------------------
SELECT TO_CHAR(first_time,'YYYY-MM-DD HH24:MI') log_time, COUNT(*) AS switches
FROM v$log_history
WHERE first_time > SYSDATE - 1
GROUP BY TO_CHAR(first_time,'YYYY-MM-DD HH24:MI')
ORDER BY log_time DESC;

PROMPT
PROMPT [15] TEMP TABLESPACE USAGE
PROMPT -------------------------------------------------------------
SELECT tablespace_name, 
       ROUND(SUM(used_blocks)*8/1024,2) used_mb, 
       ROUND(SUM(free_blocks)*8/1024,2) free_mb
FROM v$sort_segment
GROUP BY tablespace_name;

PROMPT
PROMPT [16] UNDO TABLESPACE USAGE
PROMPT -------------------------------------------------------------
SELECT d.tablespace_name, d.file_name, 
       (d.bytes - NVL(s.bytes,0))/1024/1024 used_mb,
       NVL(s.bytes,0)/1024/1024 free_mb
FROM dba_data_files d
LEFT JOIN (SELECT file_id, SUM(bytes) bytes FROM dba_free_space GROUP BY file_id) s 
ON d.file_id = s.file_id
WHERE d.tablespace_name LIKE '%UNDO%';

PROMPT
PROMPT [17] TOP SEGMENTS BY PHYSICAL READS
PROMPT -------------------------------------------------------------
SELECT owner, segment_name, segment_type, value AS physical_reads
FROM v$segment_statistics
WHERE statistic_name = 'physical reads'
AND value > 0
ORDER BY value DESC FETCH FIRST 10 ROWS ONLY;

PROMPT
PROMPT [18] FRAGMENTATION IN TABLESPACES
PROMPT -------------------------------------------------------------
SELECT tablespace_name,
       ROUND((SUM(bytes)/1024/1024),2) AS free_mb,
       COUNT(*) AS free_extents
FROM dba_free_space
GROUP BY tablespace_name
ORDER BY free_mb DESC;

PROMPT
PROMPT [19] TOP LATCH CONTENSIONS
PROMPT -------------------------------------------------------------
SELECT name, gets, misses, ROUND((misses/gets)*100,2) miss_ratio
FROM v$latch
WHERE gets > 0
ORDER BY miss_ratio DESC;

PROMPT
PROMPT [20] AWR BASELINES (IF AVAILABLE)
PROMPT -------------------------------------------------------------
SELECT * FROM dba_hist_baseline;

PROMPT =============================================================
PROMPT âœ… END OF PERFORMANCE REPORT
PROMPT =============================================================

SPOOL OFF
SET TERMOUT ON
SET FEEDBACK ON
PROMPT Report saved as: perf_report_&&rpt_time..txt
PROMPT =============================================================
```

---

## ðŸ“‹ **How to Run**

1. Save the script as:

   ```bash
   oracle_perf_check.sql
   ```

2. Connect to your Oracle DB as SYSDBA or DBA user:

   ```bash
   sqlplus / as sysdba
   ```

3. Execute the script:

   ```bash
   @oracle_perf_check.sql
   ```

4. Output file will be created in the working directory:

   ```
   perf_report_YYYYMMDD_HH24MISS.txt
   ```

---

## ðŸ§¾ **Output Sections Summary**

| Section | Focus Area    | Description                               |
| ------- | ------------- | ----------------------------------------- |
| 1â€“2     | DB Info       | Instance, mode, parameters                |
| 3       | Tablespace    | Utilization, free space                   |
| 4â€“6     | SQL           | Top SQL by CPU, Elapsed time, waits       |
| 7â€“9     | Session & I/O | Active sessions and file-level I/O        |
| 10â€“13   | Memory        | PGA, SGA, Library cache, hit ratios       |
| 14â€“16   | Logs & Temp   | Redo, temp, undo space usage              |
| 17â€“19   | Performance   | Segment reads, fragmentation, latch waits |
| 20      | AWR           | Baseline info                             |

---


